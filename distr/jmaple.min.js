'use strict';(function(a){const b=[1,15,34,57,92,135,372,560,840,1242,1144,1573,2144,2800,3640,4700,5893,7360,9144,11120,13477,16268,19320,22880,27008,31477,36600,42444,48720,55813,63800,86784,98208,110932,124432,139372,155865,173280,192400,213345];class c{constructor(r={}){this.str=r.hasOwnProperty('str')?r.str:4,this.dex=r.hasOwnProperty('dex')?r.dex:4,this.int=r.hasOwnProperty('int')?r.int:4,this.luk=r.hasOwnProperty('luk')?r.luk:4,this.hp=r.hasOwnProperty('hp')?r.hp:50,this.mp=r.hasOwnProperty('mp')?r.mp:50,this.lv=r.hasOwnProperty('lv')?r.lv:1,this.exp=r.hasOwnProperty('exp')?r.exp:0,this.def=r.hasOwnProperty('def')?r.def:0,this.att=r.hasOwnProperty('att')?r.att:0,this.attM=r.hasOwnProperty('attM')?r.attM:0,this.fame=0,this.refresh()}refresh(){for(;this.exp>=b[this.lv];)this.exp-=b[this.lv],this.lv++}}class d{constructor(r,t,u){this.id=r,this.name=t,this.inventory=u,this.lvRequerid=1,this.icon='src/img/item/default.png',this.trade=!0,this.cash=!1,this.desc='',this.slotMax=1,this.description=''}static init(){this.list=new Map,this.path='src/img/item/';const r=(t,u,v,w)=>d.add(new w(t,u,v));this.equip={create:(t,u,v)=>r(t,u,v,f),list:this.list},this.use={create:(t,u,v)=>r(t,u,v,g),list:this.list},this.setup={create:(t,u,v)=>r(t,u,v,h),list:this.list},this.etc={create:(t,u,v)=>r(t,u,v,l),list:this.list}}static add(r){return r instanceof d?(this.list.set(r.id,r),!0):(console.error('Its not Item'),!1)}static get(r){let t=this.list.get(r);return t===void 0?null:t}}d.init();class f extends d{constructor(r,t,u){super(r,t,'Equip'),super.icon=u,this.strRequerid=0,this.dexRequerid=0,this.intRequerid=0,this.lukRequerid=0,this.fameRequerid=0,this.job={beginner:!0,warrior:!0,magician:!0,bowman:!0,tief:!0,pirate:!0},this.stat=new c({hp:0,mp:0})}}class g extends d{constructor(r,t,u){super(r,t,'Use'),super.icon=u,this.stat=new c({str:0,dex:0,int:0,luk:0,hp:0,mp:0}),this.warp=!1,super.slot=100}}class h extends d{constructor(r,t,u){super(r,t,'Setup'),super.lvRequerid=0,super.icon=u,this.sec=10,this.stat=new c({str:0,dex:0,int:0,luk:0})}}class l extends d{constructor(r,t,u){super(r,t,'Etc'),super.slot=200,super.icon=d.path+u}}class n{static init(){this.list=new Map,this.active=new Map,this.completed=new Map}static create(r,t,u=!1){let v={id:r,name:t,expires:!!u,timer:{start:null,time:u,finished:null,leftoverTime:null,interval:()=>{let w=v.timer;if(null===w.start||!w.time)return!1;let z=new Date(w.start);z.setMinutes(z.getMinutes()+w.time),w.leftoverTime=parseInt((z-w.start)/1e3);const A=setInterval(()=>{return v.completed?void clearInterval(A):v.active||v.completed?void(w.leftoverTime--,0===w.leftoverTime&&(this.forfeit(v.id),clearInterval(A))):(w.leftoverTime=null,void clearInterval(A))},1e3);return!0}},active:!1,completed:!1};if(this.list.get(r)===void 0)this.list.set(r,v);else return!1;return!0}static start(r){let t=this.list.get(r);if(void 0===t||t.active||t.completed)return!1;t.timer.start=new Date,t.active=!0,t.timer.interval();const u={id:t.id,name:t.name,expires:t.expires};return this.active.set(t.id,u),!0}static complete(r){let t=this.list.get(r);if(void 0===t||!t.active||t.completed)return!1;const u=new Date;t.timer.finished=u,t.active=!1,t.completed=!0,this.active.delete(r);const v={id:t.id,name:t.name,start:t.timer.start,finished:u,leftoverTime:t.timer.leftoverTime};return this.completed.set(r,v),!0}static forfeit(r){let t=this.list.get(r);return void 0===t||!t.active||t.completed?!1:(t.active=!1,t.timer.start=null,t.timer.finished=null,this.active.delete(r),!0)}static timer(r,t){let u=this.list.get(r);if(void 0===u||!u.active||u.completed||null===u.timer.leftoverTime)return void t(0);const v=setInterval(()=>{let w=this.list.get(r).timer.leftoverTime;0>=w||u.completed?(clearInterval(v),t(0)):t(w)},1e3)}}n.init();class o{constructor(){this.nick='User',this.gender=0,this.job=0,this.gm=!1,this.mesos=0,this.nx=0,this.sp=0,this.ap=0,this.stat=new c,this.items=new Map}setItems(r){return Array.isArray(r)?void r.forEach(t=>{t.hasOwnProperty('quantity')||(t.quantity=1),this.setItem(t.id,t.quantity)}):void console.error('Is not a Array Items')}setItem(r,t=1){let u=d.list.get(r);if(void 0===u)return console.error(`This item(${r}) is not exists in the list Item`),!1;if(void 0===this.items.get(u.id)){this.items.set(u.id,{item:u,quantity:t})}else this.items.get(r).quantity+=t;return!0}get listItem(){let r=[];return this.items.forEach((t,u)=>r.push(u)),r}removeItem(r,t=null){let u=this.items.get(r);return void 0!==u&&(null===t||u.quantity<=t?this.items.delete(r):this.items.get(r).quantity-=t,!0)}quest(r){return{start:()=>n.start(r),complete:()=>n.complete(r),forfeit:()=>n.forfeit(r)}}get cm(){return{openShop:t=>{console.log(`openShop: ${t}`)},haveItem:t=>{return void 0!==this.items.get(t)},gainItem:(t,u=1)=>{return this.setItem(t,u)},changeJob:t=>{isNaN(ammount)?console.error('is not number'):this.job=t},getJob:()=>this.job,startQuest:t=>this.quest(t).start(),completeQuest:t=>this.quest(t).complete(),forfeitQuest:t=>this.quest(t).forfeit(),getMeso:()=>this.meso,gainMeso:t=>{isNaN(t)?console.error('is not number'):this.meso+=t},gainExp:t=>{isNaN(t)?console.error('is not number'):(this.stat.exp+=t,this.stat.refresh())},getLevel:()=>this.stat.lv,teachSkill:()=>{},get:t=>{return'STR'===t?this.stat.str:'DEX'===t?this.stat.dex:'INT'===t?this.stat.int:'LUK'===t?this.stat.luk:'HP'===t?this.stat.hp:'MP'===t?this.stat.mp:null},modifyNX:t=>{isNaN(t)?console.error('is not number'):this.nx=t},getPlayer:()=>{return{isGM:()=>this.gm,getGender:()=>this.gender,getitemQuantity:t=>{let u=this.items.get(t);return void 0===u?0:u.quantity}}},getChar:()=>{return{isDonator:()=>!1,getGender:()=>this.gender}}}}}class q{constructor(r){this.config={displace:!0,writing:!0,transition:'ease',dev:!1,key:'m',zIndex:100,color:{info:'#2264C8',success:'#22C85C',warning:'#FFD232',danger:'#FF0050',apply:!0}},this.listnpc=new Map,this.maps=new Map,this.container=document.getElementById(r.el),this.npc=!!r.hasOwnProperty('npc')&&r.npc,this.npc&&this.setnpc(this.npc),r.hasOwnProperty('map')&&r.map.forEach(t=>{t.hasOwnProperty('action')||(t.action=null),t.hasOwnProperty('warp')||(t.warp=!0);let u={id:t.id,name:t.name,link:t.link,action:t.action,warp:t.warp};this.maps.set(t.id,u)}),this.tagCode={color:[{id:'__color--blue',cod:'#b',el:'b'},{id:'__color--purple',cod:'#d',el:'span'},{id:'__color--bold',cod:'#e',el:'b'},{id:'__color--green',cod:'#g',el:'b'},{id:'__color--black',cod:'#k',el:'span'},{id:'__color--red',cod:'#r',el:'span'}],identifier:['#m','#p','#t','#z','#h','#v','#i','#c','#w'],remove:'#n',list:['#L','#l']},this.prepareScript=()=>{this.script=new r.script,this.script.cm=this.cm()},this.container.style.display='none',this.cmSend='simple',this.dispose=!1,this.mode=null,this.type=4,this.selection=0,this.input={el:document.createElement('input'),defaultValue:0,min:0,max:null,restart:()=>{this.input.defaultValue=0,this.input.min=0,this.input.max=null}},this.input.el.setAttribute('class',this.config.key+'__input'),this.character=new o}registered(r){let t=[];switch(r){case'npc':this.listnpc.forEach((u,v)=>t.push(v));break;case'map':this.maps.forEach((u,v)=>t.push(v));break;case'item':this.character?t=this.character.listItem:console.error('Extension character is requerid.');break;default:console.error('null, just type this["npc", "map", "item"]');}return 0>=t.length?null:t}setnpc(r){const t=u=>{let v=['id','name','img'];for(let w of v)if(!u.hasOwnProperty(w))return console.error('An npc requires as properties: {id, name, img}'),!1;return!0};if(Array.isArray(r))for(let u of r){if(!t(u))return;this.listnpc.get(u.id)===void 0&&this.listnpc.set(u.id,u)}else{if(!t(r))return;this.listnpc.get(r.id)===void 0&&this.listnpc.set(r.id,r)}}get html(){let r=document.createElement('div');r.setAttribute('class',this.config.key),this.head=document.createElement('div'),this.head.setAttribute('class',this.config.key+'__head');let t=document.createElement('div');t.setAttribute('class',this.config.key+'__body');let u=document.createElement('div');u.setAttribute('class',this.config.key+'__body__npc');let v=document.createElement('div');v.setAttribute('class',this.config.key+'__body__npc__img');let w=document.createElement('img');this.npc&&w.setAttribute('src',this.npc.img),v.appendChild(w),u.appendChild(v);let z=document.createElement('p');z.setAttribute('class',this.config.key+'__body__npc__name'),this.npc&&z.appendChild(document.createTextNode(this.npc.name)),u.appendChild(z),this.npc&&t.appendChild(u),this.dialog=document.createElement('div'),this.dialog.setAttribute('class',this.config.key+'__body__dialog'),this.info=document.createElement('div'),this.info.setAttribute('class',this.config.key+'__body__dialog__info'),this.dialog.appendChild(this.info),this.btnsInterrogate1=document.createElement('div'),this.btnsInterrogate1.setAttribute('class',this.config.key+'__body__dialog__btn-interrogate'),this.btnPrev=document.createElement('button'),this.btnPrev.setAttribute('class',this.config.key+'__body__dialog__btn-interrogate--prev'),this.btnPrev.appendChild(document.createTextNode('PREV')),('test'===this.cmSend||'nextprev'===this.cmSend)&&this.btnsInterrogate1.appendChild(this.btnPrev),this.btnNext=document.createElement('button'),this.btnNext.setAttribute('class',this.config.key+'__body__dialog__btn-interrogate--next'),this.btnNext.appendChild(document.createTextNode('NEXT')),('test'===this.cmSend||'next'===this.cmSend||'nextprev'===this.cmSend)&&this.btnsInterrogate1.appendChild(this.btnNext),this.dialog.appendChild(this.btnsInterrogate1),t.appendChild(this.dialog);let A=document.createElement('div');A.setAttribute('class',this.config.key+'__footer');let B=document.createElement('div');return B.setAttribute('class',this.config.key+'__footer__btn-exit'),this.btnEndChat=document.createElement('button'),this.btnEndChat.setAttribute('class',this.config.key+'__footer__btn-exit--end-chat'),this.btnEndChat.appendChild(document.createTextNode('END CHAT')),B.appendChild(this.btnEndChat),A.appendChild(B),this.btnsInterrogate2=document.createElement('div'),this.btnsInterrogate2.setAttribute('class',this.config.key+'__footer__btn-interrogate'),this.btnYes=document.createElement('button'),this.btnYes.setAttribute('class',this.config.key+'__footer__btn-interrogate--yes'),this.btnYes.appendChild(document.createTextNode('ok'===this.cmSend?'OK':'acceptdecline'===this.cmSend?'Accept':'YES')),('test'===this.cmSend||'yesno'===this.cmSend||'ok'===this.cmSend||'acceptdecline'===this.cmSend)&&this.btnsInterrogate2.appendChild(this.btnYes),this.btnNo=document.createElement('button'),this.btnNo.setAttribute('class',this.config.key+'__footer__btn-interrogate--no'),this.btnNo.appendChild(document.createTextNode('acceptdecline'===this.cmSend?'Decline':'NO')),('test'===this.cmSend||'yesno'===this.cmSend||'acceptdecline'===this.cmSend)&&this.btnsInterrogate2.appendChild(this.btnNo),A.appendChild(this.btnsInterrogate2),r.appendChild(this.head),r.appendChild(t),r.appendChild(A),r}end(){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.container.style.display='none',this.dispose=!1,this.cmExecuted=!1}structure(r){function t(){let I=[...B];A.push(I),B=[]}function u(){if(''!==z.text){let I={cod:z.cod,text:z.text,value:z.value};z.text='',z.value='',z.cod=null,C?F.push(I):B.push(I)}}function v(){let I={value:D,content:F};E.push(I),D='',z.text='',C=!1,F=[]}function w(I){let J=0,K='';for(;J<=I;){if('#'===r.substr(G+J,1)){K=r.substr(G,J),''==K?G+=J:(J++,G+=J);break}J++}return K}let z={cod:null,text:'',value:''},A=[],B=[],C=!1,D='',E=[],F=[],G=0;for(const H=I=>{if(I===this.tagCode.remove)return void u();for(const K of this.tagCode.color)if(I===K.cod)return u(),void(z.cod=I);const J=K=>{function L(N,O){let P=N();return void 0===P?void 0:'name'===O?void(M=P.name):void('icon'==O&&(M=P.icon))}G+=2;let M=null;switch(K){case'#m':L(()=>this.maps.get(parseInt(w(10))),'name');break;case'#p':L(()=>this.listnpc.get(parseInt(w(10))),'name');break;case'#t':case'#z':L(()=>d.list.get(parseInt(w(10))),'name');break;case'#h':' '===w(2)?M=this.character.nick:(G++,M=I);break;case'#i':case'#v':let N=z.cod;u();let O=d.list.get(parseInt(w(10)));if(void 0===O)break;z.cod=K,z.text=O.name,z.value=O.icon,u(),z.cod=N,M='';break;case'#c':let P=this.character.items.get(parseInt(w(10)));M=void 0===P?0:P.quantity;break;case'#w':let Q=z.cod;u(),t(),z.cod=Q,M='';}return null===M&&console.error(`Not found or the value is long`),G-=2,M};for(const K of this.tagCode.identifier)if(I===K){let L=J(K);return void(z.text+=L)}z.text+=I};G<r.length;){let I=r.substr(G,1);if('#'===I){if(I=r.substr(G,2),'##'===I){z.text+='#',G++;continue}if(I===this.tagCode.list[0]&&!C){G+=2,D=w(3),''==D?G++:(u(),z.cod=null,C=!0);continue}else C?I===this.tagCode.list[1]?(u(),v()):H(I):H(I);G+=2}else z.text+=I,G++}u(),t(),this.write(A,0===E.length?null:E)}write(r,t=null){const u=v=>{for(const A of this.tagCode.color)if(v.cod===A.cod){let B=document.createElement(A.el);return B.setAttribute('class',this.config.key+A.id),B.appendChild(document.createTextNode(v.text)),B}let w=document.createElement('div');w.setAttribute('class',this.config.key+'__icon');let z=document.createElement('img');return z.setAttribute('src',v.value),z.setAttribute('title',v.text),w.appendChild(z),w};for(;this.info.firstChild;)this.info.removeChild(this.info.firstChild);if(r.forEach(v=>{let w=document.createElement('p');w.setAttribute('class',this.config.key+'__body__dialog__info--text'),v.forEach(z=>{if(null===z.cod){let A=document.createElement('span');A.appendChild(document.createTextNode(z.text)),w.appendChild(A)}else w.appendChild(u(z))}),this.info.appendChild(w)}),this.config.writing){function v(K){let L=0,M=!1;for(const N of K.children)'DIV'===N.tagName?(z.push([L,N.firstChild]),A.push(''),M=!0):(A.push(N.innerHTML),N.innerHTML=''),L++;M&&(B.push({index:C,el:[...z]}),z=[]),C++}function w(K){if(D>K.children.length-1)return D=0,E=0,!1;if(0<B.length)for(let M=0;M<B.length;M++)if(G===B[M].index)for(const N of B[M].el)if(D===N[0])return K.children[D].appendChild(N[1]),D++,F++,!0;let L=H(F);return K.children[D].innerHTML+=L[E],E++,E>L.length-1&&(E=0,D++,F++),!0}let z=[],A=[],B=[],C=0;for(let K=0;K<r.length;K++)v(this.info.children[K]);for(const K of B)for(const L of K.el)this.info.children[K.index].children[L[0]].removeChild(L[1]);let D=0,E=0,F=0,G=0;const H=K=>A[K].split('');let I=!1;const J=setInterval(()=>{G>=r.length?(I=!0,F=0,clearInterval(J)):!w(this.info.children[G])&&G++},35);this.dialog.onclick=()=>{if(!I)for(clearInterval(J);;)if(G>=r.length){I=!0,F=0;break}else w(this.info.children[G])||G++}}if(null!==t){let v=document.createElement('ul');v.setAttribute('class',this.config.key+'__body__dialog__info--alternatives'),t.forEach(w=>{let z=document.createElement('li');for(const A of w.content)null===A.cod?z.appendChild(document.createTextNode(A.text)):z.appendChild(u(A));z.onclick=()=>{if(!this.dispose){let A=parseInt(w.value);this.selection=isNaN(A)?w.value:A,this.mode=1,this.nextWindow()}else this.end()},v.appendChild(z)}),this.info.appendChild(v)}('getnumber'===this.cmSend||'test'===this.cmSend)&&(this.input.el.setAttribute('value',this.input.defaultValue),this.info.appendChild(this.input.el),this.input.el.focus(),this.input.el.select())}cm(){this.cmExecuted=!1;const r=(u,v)=>{switch(this.cmExecuted=!0,this.cmSend=u,this.structure(v),u){case'simple':this.type=4;break;case'ok':this.type=0;break;case'next':this.type=0;break;case'prev':this.type=5;break;case'nextprev':this.type=0;break;case'yesno':this.type=1;break;case'acceptdecline':this.type=12;break;case'getnumber':this.type=3;break;case'test':this.type=-1;break;default:this.cmExecuted=!1;}this.config.dev&&console.log(`Mode: ${this.mode}, Type: ${u}(${this.type}), Selection : ${this.selection}`)};let t={sendSimple:u=>{switch(this.cmSend){case'ok':case'getNumber':this.btnsInterrogate2.removeChild(this.btnYes);break;case'yesno':case'acceptdecline':for(;this.btnsInterrogate2.firstChild;)this.btnsInterrogate2.removeChild(this.btnsInterrogate2.firstChild);break;case'next':this.btnsInterrogate1.removeChild(this.btnNext);break;case'prev':this.btnsInterrogate1.removeChild(this.btnPrev),this.btnsInterrogate2.removeChild(this.btnYes);break;case'nextprev':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);break;case'test':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);for(;this.btnsInterrogate2.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate2.firstChild);}r('simple',u)},sendOk:u=>{switch(this.btnYes.innerHTML='OK',this.cmSend){case'simple':this.btnsInterrogate2.appendChild(this.btnYes);break;case'getnumber':break;case'yesno':case'acceptdecline':this.btnsInterrogate2.removeChild(this.btnNo);break;case'next':this.btnsInterrogate1.removeChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnYes);break;case'prev':this.btnsInterrogate1.removeChild(this.btnPrev);break;case'nextprev':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);this.btnsInterrogate2.appendChild(this.btnYes);break;case'test':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);this.btnsInterrogate2.removeChild(this.btnNo);}r('ok',u)},sendNext:u=>{switch(this.cmSend){case'simple':this.btnsInterrogate1.appendChild(this.btnNext);break;case'ok':case'getnumber':this.btnsInterrogate2.removeChild(this.btnYes),this.btnsInterrogate1.appendChild(this.btnNext);break;case'yesno':case'acceptdecline':for(;this.btnsInterrogate2.firstChild;)this.btnsInterrogate2.removeChild(this.btnsInterrogate2.firstChild);this.btnsInterrogate1.appendChild(this.btnNext);break;case'prev':this.btnsInterrogate1.removeChild(this.btnPrev),this.btnsInterrogate2.removeChild(this.btnYes);break;case'nextprev':this.btnsInterrogate1.removeChild(this.btnPrev);break;case'test':for(;this.btnsInterrogate2.firstChild;)this.btnsInterrogate2.removeChild(this.btnsInterrogate2.firstChild);this.btnsInterrogate1.removeChild(this.btnPrev);}r('next',u)},sendPrev:u=>{switch(this.btnYes.innerHTML='OK',this.cmSend){case'simple':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate2.appendChild(this.btnYes);break;case'ok':case'getnumber':this.btnsInterrogate1.appendChild(this.btnPrev);break;case'yesno':case'acceptdecline':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate2.removeChild(this.btnNo);break;case'next':this.btnsInterrogate1.removeChild(this.btnNext),this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate2.appendChild(this.btnYes);break;case'nextprev':this.btnsInterrogate1.removeChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnYes);break;case'test':this.btnsInterrogate1.removeChild(this.next),this.btnsInterrogate2.removeChild(this.btnNo);}r('prev',u)},sendNextPrev:u=>{switch(this.cmSend){case'simple':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate1.appendChild(this.btnNext);break;case'ok':case'getnumber':this.btnsInterrogate2.removeChild(this.btnYes);break;case'yesno':case'acceptdecline':for(;this.btnsInterrogate2.firstChild;)this.btnsInterrogate2.removeChild(this.btnsInterrogate2.firstChild);this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate1.appendChild(this.btnNext);break;case'next':this.btnsInterrogate1.insertBefore(this.btnPrev,this.btnNext);break;case'prev':this.btnsInterrogate1.appendChild(this.btnNext),this.btnsInterrogate2.removeChild(this.btnYes);break;case'test':for(;this.btnsInterrogate2.firstChild;)this.btnsInterrogate2.removeChild(this.btnsInterrogate2.firstChild);}r('nextprev',u)},sendYesNo:u=>{switch(this.btnYes.innerHTML='YES',this.btnNo.innerHTML='NO',this.cmSend){case'simple':this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'ok':case'getnumber':this.btnsInterrogate2.appendChild(this.btnNo);break;case'acceptdecline':break;case'next':this.btnsInterrogate1.removeChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'prev':this.btnsInterrogate1.removeChild(this.btnPrev);break;case'nextprev':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);case'test':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);}r('yesno',u)},sendAcceptDecline:u=>{switch(this.btnYes.innerHTML='Accept',this.btnNo.innerHTML='Decline',this.cmSend){case'simple':this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'ok':case'getnumber':this.btnsInterrogate2.appendChild(this.btnNo);break;case'yesno':break;case'next':this.btnsInterrogate1.removeChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'prev':this.btnsInterrogate1.removeChild(this.btnPrev);break;case'nextprev':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);case'test':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);}r('acceptdecline',u)},sendGetNumber:(u,v,w,z)=>{switch(this.btnYes.innerHTML='ok',this.input.defaultValue=v,this.input.min=w,this.input.max=z,this.cmSend){case'simple':this.btnsInterrogate2.appendChild(this.btnYes);break;case'ok':break;case'yesno':case'acceptdecline':this.btnsInterrogate2.removeChild(this.btnNo);break;case'next':this.btnsInterrogate1.removeChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnYes);break;case'prev':this.btnsInterrogate1.removeChild(this.btnPrev);break;case'nextprev':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);this.btnsInterrogate2.appendChild(this.btnYes);break;case'test':for(;this.btnsInterrogate1.firstChild;)this.btnsInterrogate1.removeChild(this.btnsInterrogate1.firstChild);this.btnsInterrogate2.removeChild(this.btnNo);}r('getnumber',u)},sendTest:u=>{switch(this.btnYes.innerHTML='YES',this.input.defaultValue=0,this.input.min=0,this.input.max=null,this.cmSend){case'simple':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate1.appendChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'ok':case'getnumber':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate1.appendChild(this.btnNext),this.btnsInterrogate2.appendChild(this.btnNo);break;case'yesno':case'acceptdecline':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate1.appendChild(this.btnNext);case'next':this.btnsInterrogate1.appendChild(this.btnPrev),this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'prev':this.btnsInterrogate1.insertBefore(this.btnNext,btn.btnPrev),this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);break;case'nextprev':this.btnsInterrogate2.appendChild(this.btnYes),this.btnsInterrogate2.appendChild(this.btnNo);}r('test',u)},warp:(u,v=0)=>{let w=this.maps.get(u);null!==w.action&&w.action(),w.warp&&(window.location.href=w.link),this.config.dev&&console.log(`warp(${w.id}): ${w.link}`)},dispose:()=>this.dispose=!0};return!1===this.character?t:Object.assign(t,this.character.cm)}nextWindow(){if('getnumber'===this.cmSend||'test'===this.cmSend){let r=parseInt(this.input.el.value);if(r<this.input.min||r>this.input.max&&null!==this.input.max||isNaN(r))return this.input.el.style.color=this.config.color.danger,void setTimeout(()=>{this.input.el.style.color='initial'},500);this.selection=r,this.input.restart()}return'step'===this.config.transition?void(this.script.action(this.mode,this.type,this.selection),this.selection=0,!this.cmExecuted&&this.dispose&&this.end(),this.cmExecuted=!1):(this.container.style.opacity=0,setTimeout(()=>{'ease'===this.config.transition&&(this.container.style.transition='0.3s ease'),this.script.action(this.mode,this.type,this.selection),this.selection=0,this.container.style.opacity=1,!this.cmExecuted&&this.dispose&&this.end()},150),'ease'===this.config.transition&&(this.container.style.transition='0s'),void(this.cmExecuted=!1))}events(){const r=A=>{this.mode=A,this.dispose?(this.config.dev&&console.log(`Mode: ${this.mode}, Type: ${this.type}, Selection : ${this.selection}`),this.end()):this.nextWindow()};this.btnEndChat.onclick=()=>{this.mode=-1,this.script.hasOwnProperty('action')&&this.script.action(this.mode,this.type,0),this.end()},this.btnYes.onclick=()=>r(1),this.btnNo.onclick=()=>r(0),this.btnPrev.onclick=()=>r(0),this.btnNext.onclick=()=>r(1);let t={getted:!1,x:0,y:0},u={x:0,y:0},v=0,w=0,z=()=>{this.container.onmousemove=null,t.getted=!1,u.x=v,u.y=w};this.head.onmouseup=()=>z(),this.container.onmouseup=()=>z(),this.config.displace&&(this.head.onmousedown=()=>this.container.onmousemove=A=>{t.getted||(t.x=A.clientX,t.y=A.clientY,t.getted=!0),v=u.x+A.clientX-t.x,w=u.y+A.clientY-t.y,this.container.firstChild.style.transform=`translate(${v}px, ${w}px)`})}show(){this.prepareScript(),this.container.classList.add('jmaple'),this.container.style.display='flex',this.container.style.zIndex=`${this.config.zIndex}`,this.container.appendChild(this.html),this.script.start(),this.events(),!this.cmExecuted&&this.dispose&&this.end()}}a.Stat=c,a.Item=d,a.Quest=n,a.Character=o,a.JMaple=q})('undefined'==typeof window?global:window);